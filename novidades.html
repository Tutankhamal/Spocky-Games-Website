<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="pt-br">
    <meta name="description" content="Spocky Games - O melhor canal de jogos do Brasil!">
    <meta name="author" content="Tutankhamal, renejr, Spocky Games">
    <meta name="keywords" content="jogos, comunidade, Spocky Games, loja, YouTube, Discord">
    <link rel="canonical" href="https://spockygames.com.br">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Spocky Games">
    <meta property="og:description" content="Spocky Games - O melhor canal de jogos do Brasil!">
    <meta property="og:image" content="https://imgur.com/JuOYAFI.gif">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="270">
    <meta property="og:url" content="https://spockygames.com.br"> 
    <meta property="og:site_name" content="Spocky Games"> 
    <meta property="og:type" content="website">
    <meta property="og:color" content="#00BFFF">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Spocky Games">
    <meta name="twitter:description" content="Spocky Games - O melhor canal de jogos do Brasil!">
    <meta name="twitter:image" content="https://imgur.com/JuOYAFI.gif">

    <title>Spocky Games | Novidades</title>

    <!-- Fonts and Styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
</head>
<body>
    <canvas id="retro-bg"></canvas>
    <div class="background-container"></div>
    
    <header class="navbar">
        <div class="logo-container">
            <img src="/assets/images/logo_nav.png" alt="Spocky Games Logo" class="logo">
            <h1 class="site-title"><a href="index.html">Spocky Games</a></h1>
        </div>
        
        <nav class="nav-links">
            <ul>
                <li><a href="index.html">Início</a></li>
                <li><a href="loja.html">Loja</a></li>
                <li><a href="aovivo.html">Ao Vivo</a></li>
                <li><a href="ondemand.html">On Demand</a></li>
                <li><a href="jogos.html">Jogos</a></li>
                <li><a href="novidades.html" class="active">Novidades</a></li>
                <li><a href="parceiros.html">Parceiros</a></li>
                <li><a href="sobre.html">Sobre</a></li>
                <li><a href="contato.html">Contato</a></li>
            </ul>
        </nav>
        
        <div class="hamburger">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
    </header>
    
    <main>
        <section class="page-header animated-section snap-section">
          <div class="animated-content">  
            <h1 class="glitch" data-text="Novidades">Novidades</h1>
            <p>Fique por dentro das últimas notícias! (EM BREVE)</p>
          </div> 
        </section>
        
<section class="news-section snap-section">
  <h2 class="section-title">Curiosidades do Canal</h2>
  <div id="curiosities-section" class="news-grid"></div>
</section>
        
        <section class="newsletter-section snap-section" data-aos="fade-up">
            <div class="newsletter-container">
                <div class="newsletter-content">
                    <h2>Inscreva-se na nossa Newsletter</h2>
                    <p>Receba as últimas novidades sobre jogos retrô e atualizações do canal diretamente no seu e-mail.</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Seu melhor e-mail" required>
                        <button type="submit" class="neon-button">Inscrever-se</button>
                    </form>
                </div>
            </div>
        </section>
    </main>
    <section class="parceiros-carroussel snap-section">
  <div class="carousel-container">
    <div class="carousel-track">
      <div class="carousel-slide">
        <img src="/assets/images/partnerlogos/ecast.png" alt="E-Cast" data-link="https://www.ecast.site">
      </div>
      <div class="carousel-slide">
        <img src="/assets/images/partnerlogos/entretonic.png" alt="Entretonic" data-link="https://instagram.com/entretonic">
      </div>
      <div class="carousel-slide">
        <img src="/assets/images/partnerlogos/sejaumpatrocinador.png" alt="Entretonic" data-link="contato.html">
      </div>
    </div>
  </div>
</section>
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Spocky Games. Todos os direitos reservados.</p>
            <div class="social-icons">
                <a href="https://youtube.com/@SpockyGames" target="_blank" class="social-icon youtube">
                    <i class="fab fa-youtube"></i>
                </a>                
                <a href="https://instagram.com/SpockyGames" target="_blank" class="social-icon instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://www.tiktok.com/@spockygames" target="_blank" class="social-icon tiktok">
                    <i class="fab fa-tiktok"></i>
                </a>
                <a href="https://discord.com/invite/5Zags8Xaz5" target="_blank" class="social-icon discord">
                    <i class="fab fa-discord"></i>
                </a>
                <a href="https://chat.whatsapp.com/JkQvyyFUzZn4y2mbkuD7mv" target="_blank" class="social-icon whatsapp">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>
        </div>
    </footer>
    
    <script src="/assets/js/script.js"></script>
<script>
  const API_KEY = 'AIzaSyCwe_Y77Ah1DPGcd3QhAntk7ii8JhJi1oc';
  const CHANNEL_ID = 'UCSPC6X4M-tVPeK4IZMbK5aw';
  const CACHE_KEY = 'curiosities_cache';
  const CACHE_TTL = 6 * 60 * 60 * 1000; // 6 horas

  function formatDate(iso) {
    const d = new Date(iso);
    return d.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' });
  }

  function getDurationSeconds(start, end) {
    return (new Date(end) - new Date(start)) / 1000;
  }

  function secondsToHMS(seconds) {
    const h = Math.floor(seconds / 3600);
    const m = Math.floor((seconds % 3600) / 60);
    const s = Math.floor(seconds % 60);
    return `${h}h ${m}m ${s}s`;
  }

  function createCard({ title, date, description, url, thumbnail, tag }) {
    return `
      <div class="news-card">
        <div class="news-image">
          <img src="${thumbnail}" alt="${title}">
          <div class="news-tag">${tag}</div>
        </div>
        <div class="news-content">
          <div class="news-date">${date}</div>
          <h3>${title}</h3>
          <p class="news-excerpt">${description}</p>
          <a href="${url}" target="_blank" class="read-more">Assistir <i class="fas fa-arrow-right"></i></a>
        </div>
      </div>`;
  }

  async function getUploadsPlaylistId() {
    const res = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`);
    const data = await res.json();
    return data.items[0].contentDetails.relatedPlaylists.uploads;
  }

  async function getAllVideos(playlistId) {
    let videos = [];
    let pageToken = '';
    do {
      const res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=contentDetails&playlistId=${playlistId}&maxResults=50&pageToken=${pageToken}&key=${API_KEY}`);
      const data = await res.json();
      videos = videos.concat(data.items);
      pageToken = data.nextPageToken || '';
    } while (pageToken);
    return videos.map(v => v.contentDetails.videoId);
  }

  async function getVideoDetails(ids) {
    const chunks = [];
    for (let i = 0; i < ids.length; i += 50) {
      const chunk = ids.slice(i, i + 50);
      const res = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,liveStreamingDetails,contentDetails&id=${chunk.join(',')}&key=${API_KEY}`);
      const data = await res.json();
      chunks.push(...data.items);
    }
    return chunks;
  }

  function saveToCache(data) {
    const payload = {
      timestamp: Date.now(),
      data
    };
    localStorage.setItem(CACHE_KEY, JSON.stringify(payload));
  }

  function loadFromCache() {
    const raw = localStorage.getItem(CACHE_KEY);
    if (!raw) return null;

    try {
      const parsed = JSON.parse(raw);
      if (Date.now() - parsed.timestamp < CACHE_TTL) {
        return parsed.data;
      }
    } catch (e) {
      return null;
    }

    return null;
  }

  async function renderCuriosities() {
    let curiosities = loadFromCache();
    if (!curiosities) {
      const playlistId = await getUploadsPlaylistId();
      const ids = await getAllVideos(playlistId);
      const videos = await getVideoDetails(ids);

      const mostViewed = videos.reduce((a, b) => (+a.statistics.viewCount > +b.statistics.viewCount ? a : b));

      const lives = videos.filter(v => v.liveStreamingDetails?.actualEndTime);
      const longestLive = lives.reduce((a, b) => {
        const aDur = getDurationSeconds(a.liveStreamingDetails.actualStartTime, a.liveStreamingDetails.actualEndTime);
        const bDur = getDurationSeconds(b.liveStreamingDetails.actualStartTime, b.liveStreamingDetails.actualEndTime);
        return aDur > bDur ? a : b;
      }, lives[0]);

      const firstLive = lives.reduce((a, b) => (
        new Date(a.liveStreamingDetails.actualStartTime) < new Date(b.liveStreamingDetails.actualStartTime) ? a : b
      ), lives[0]);

      curiosities = [
        {
          title: mostViewed.snippet.title,
          date: formatDate(mostViewed.snippet.publishedAt),
          description: `Este é o vídeo mais assistido do canal, com mais de ${Number(mostViewed.statistics.viewCount).toLocaleString('pt-BR')} visualizações.`,
          url: `https://www.youtube.com/watch?v=${mostViewed.id}`,
          thumbnail: mostViewed.snippet.thumbnails.medium.url,
          tag: "Mais Visto"
        },
        {
          title: longestLive.snippet.title,
          date: formatDate(longestLive.snippet.publishedAt),
          description: `Esta foi a live mais longa do canal, com duração de ${secondsToHMS(getDurationSeconds(longestLive.liveStreamingDetails.actualStartTime, longestLive.liveStreamingDetails.actualEndTime))}.`,
          url: `https://www.youtube.com/watch?v=${longestLive.id}`,
          thumbnail: longestLive.snippet.thumbnails.medium.url,
          tag: "Live Mais Longa"
        },
        {
          title: firstLive.snippet.title,
          date: formatDate(firstLive.snippet.publishedAt),
          description: `Esta foi a primeira live registrada no canal.`,
          url: `https://www.youtube.com/watch?v=${firstLive.id}`,
          thumbnail: firstLive.snippet.thumbnails.medium.url,
          tag: "Primeira Live"
        }
      ];

      saveToCache(curiosities);
    }

    document.getElementById('curiosities-section').innerHTML = curiosities.map(createCard).join('');
  }

  renderCuriosities();
</script>
    
</body>
</html>
